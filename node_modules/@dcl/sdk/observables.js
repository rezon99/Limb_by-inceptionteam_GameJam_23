import { Observable } from './internal/Observable';
import { subscribe } from '~system/EngineApi';
let subscribeFunction = subscribe;
function createSubscriber(eventName) {
    return () => {
        subscribeFunction({ eventId: eventName }).catch(console.error);
    };
}
export const onEnterSceneObservable = new Observable(createSubscriber('onEnterScene'));
export const onEnterScene = onEnterSceneObservable;
export const onLeaveSceneObservable = new Observable(createSubscriber('onLeaveScene'));
export const onLeaveScene = onLeaveSceneObservable;
export const onSceneReadyObservable = new Observable(createSubscriber('sceneStart'));
export const onPlayerExpressionObservable = new Observable(createSubscriber('playerExpression'));
export const onVideoEvent = new Observable(createSubscriber('videoEvent'));
export const onProfileChanged = new Observable(createSubscriber('profileChanged'));
export const onPlayerConnectedObservable = new Observable(createSubscriber('playerConnected'));
export const onPlayerDisconnectedObservable = new Observable(createSubscriber('playerDisconnected'));
export const onRealmChangedObservable = new Observable(createSubscriber('onRealmChanged'));
export const onPlayerClickedObservable = new Observable(createSubscriber('playerClicked'));
export const onCommsMessage = new Observable(createSubscriber('comms'));
export function setSubscribeFunction(fn) {
    subscribeFunction = fn;
}
export async function pollEvents(sendBatch) {
    const { events } = await sendBatch({ actions: [] });
    for (const e of events) {
        if (e.generic) {
            const data = JSON.parse(e.generic.eventData);
            switch (e.generic.eventId) {
                case 'onEnterScene': {
                    onEnterSceneObservable.notifyObservers(data);
                    break;
                }
                case 'onLeaveScene': {
                    onLeaveSceneObservable.notifyObservers(data);
                    break;
                }
                case 'sceneStart': {
                    onSceneReadyObservable.notifyObservers(data);
                    break;
                }
                case 'playerExpression': {
                    onPlayerExpressionObservable.notifyObservers(data);
                    break;
                }
                case 'videoEvent': {
                    const videoData = data;
                    onVideoEvent.notifyObservers(videoData);
                    break;
                }
                case 'profileChanged': {
                    onProfileChanged.notifyObservers(data);
                    break;
                }
                case 'playerConnected': {
                    onPlayerConnectedObservable.notifyObservers(data);
                    break;
                }
                case 'playerDisconnected': {
                    onPlayerDisconnectedObservable.notifyObservers(data);
                    break;
                }
                case 'onRealmChanged': {
                    onRealmChangedObservable.notifyObservers(data);
                    break;
                }
                case 'playerClicked': {
                    onPlayerClickedObservable.notifyObservers(data);
                    break;
                }
                case 'comms': {
                    onCommsMessage.notifyObservers(data);
                    break;
                }
            }
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2JzZXJ2YWJsZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJzcmMvb2JzZXJ2YWJsZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHVCQUF1QixDQUFBO0FBRWxELE9BQU8sRUFBdUMsU0FBUyxFQUFFLE1BQU0sbUJBQW1CLENBQUE7QUFFbEYsSUFBSSxpQkFBaUIsR0FBcUIsU0FBUyxDQUFBO0FBaVluRCxTQUFTLGdCQUFnQixDQUFDLFNBQWlCO0lBQ3pDLE9BQU8sR0FBRyxFQUFFO1FBQ1YsaUJBQWlCLENBQUMsRUFBRSxPQUFPLEVBQUUsU0FBUyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFBO0lBQ2hFLENBQUMsQ0FBQTtBQUNILENBQUM7QUFPRCxNQUFNLENBQUMsTUFBTSxzQkFBc0IsR0FBRyxJQUFJLFVBQVUsQ0FBMEIsZ0JBQWdCLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQTtBQUkvRyxNQUFNLENBQUMsTUFBTSxZQUFZLEdBQUcsc0JBQXNCLENBQUE7QUFPbEQsTUFBTSxDQUFDLE1BQU0sc0JBQXNCLEdBQUcsSUFBSSxVQUFVLENBQTBCLGdCQUFnQixDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUE7QUFLL0csTUFBTSxDQUFDLE1BQU0sWUFBWSxHQUFHLHNCQUFzQixDQUFBO0FBT2xELE1BQU0sQ0FBQyxNQUFNLHNCQUFzQixHQUFHLElBQUksVUFBVSxDQUF3QixnQkFBZ0IsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFBO0FBTTNHLE1BQU0sQ0FBQyxNQUFNLDRCQUE0QixHQUFHLElBQUksVUFBVSxDQUN4RCxnQkFBZ0IsQ0FBQyxrQkFBa0IsQ0FBQyxDQUNyQyxDQUFBO0FBTUQsTUFBTSxDQUFDLE1BQU0sWUFBWSxHQUFHLElBQUksVUFBVSxDQUF3QixnQkFBZ0IsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFBO0FBTWpHLE1BQU0sQ0FBQyxN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Q0FBQyxDQUFDO29CQUNaLGNBQWMsQ0FBQyxlQUFlLENBQUMsSUFBd0IsQ0FBQyxDQUFBO29CQUN4RCxNQUFLO2lCQUNOO2FBQ0Y7U0FDRjtLQUNGO0FBQ0gsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICcuL2ludGVybmFsL09ic2VydmFibGUnXG5pbXBvcnQgeyBRdWF0ZXJuaW9uVHlwZSwgVmVjdG9yM1R5cGUgfSBmcm9tICdAZGNsL2VjcydcbmltcG9ydCB7IE1hbnlFbnRpdHlBY3Rpb24sIFNlbmRCYXRjaFJlc3BvbnNlLCBzdWJzY3JpYmUgfSBmcm9tICd+c3lzdGVtL0VuZ2luZUFwaSdcblxubGV0IHN1YnNjcmliZUZ1bmN0aW9uOiB0eXBlb2Ygc3Vic2NyaWJlID0gc3Vic2NyaWJlXG5cbi8qKiBAcHVibGljICovXG5leHBvcnQgdHlwZSBJbnB1dEV2ZW50UmVzdWx0ID0ge1xuICAvKiogT3JpZ2luIG9mIHRoZSByYXksIHJlbGF0aXZlIHRvIHRoZSBzY2VuZSAqL1xuICBvcmlnaW46IFZlY3RvcjNUeXBlXG4gIC8qKiBEaXJlY3Rpb24gdmVjdG9yIG9mIHRoZSByYXkgKG5vcm1hbGl6ZWQpICovXG4gIGRpcmVjdGlvbjogVmVjdG9yM1R5cGVcbiAgLyoqIElEIG9mIHRoZSBwb2ludGVyIHRoYXQgdHJpZ2dlcmVkIHRoZSBldmVudCAqL1xuICBidXR0b25JZDogbnVtYmVyXG4gIC8qKiBEb2VzIHRoaXMgcG9pbnRlciBldmVudCBoaXQgYW55IG9iamVjdD8gKi9cbiAgaGl0Pzoge1xuICAgIC8qKiBMZW5ndGggb2YgdGhlIHJheSAqL1xuICAgIGxlbmd0aDogbnVtYmVyXG4gICAgLyoqIElmIHRoZSByYXkgaGl0cyBhIG1lc2ggdGhlIGludGVyc2VjdGlvbiBwb2ludCB3aWxsIGJlIHRoaXMgKi9cbiAgICBoaXRQb2ludDogVmVjdG9yM1R5cGVcbiAgICAvKiogSWYgdGhlIG1lc2ggaGFzIGEgbmFtZSwgaXQgd2lsbCBiZSBhc3NpZ25lZCB0byBtZXNoTmFtZSAqL1xuICAgIG1lc2hOYW1lOiBzdHJpbmdcbiAgICAvKiogTm9ybWFsIG9mIHRoZSBoaXQgKi9cbiAgICBub3JtYWw6IFZlY3RvcjNUeXBlXG4gICAgLyoqIE5vcm1hbCBvZiB0aGUgaGl0LCBpbiB3b3JsZCBzcGFjZSAqL1xuICAgIHdvcmxkTm9ybWFsOiBWZWN0b3IzVHlwZVxuICAgIC8qKiBIaXQgZW50aXR5IElEIGlmIGFueSAqL1xuICAgIGVudGl0eUlkOiB1bmtub3duXG4gIH1cbn1cblxuLyoqIEBwdWJsaWMgKi9cbmV4cG9ydCB0eXBlIEdsb2JhbElucHV0RXZlbnRSZXN1bHQgPSBJbnB1dEV2ZW50UmVzdWx0ICYge1xuICAvKipcbiAgICogRE9XTiA9IDAsXG4gICAqIFVQID0gMVxuICAgKi9cbiAgdHlwZTogMCB8IDFcbn1cblxuLyoqIEBwdWJsaWMgKi9cbmV4cG9ydCB0eXBlIFJheWNhc3RSZXNwb25zZVBheWxvYWQ8VD4gPSB7XG4gIHF1ZXJ5SWQ6IHN0cmluZ1xuICBxdWVyeVR5cGU6IHN0cmluZ1xuICBwYXlsb2FkOiBUXG59XG5cbi8qKiBAcHVibGljICovXG5leHBvcnQgdHlwZSBHaXptb0RyYWdFbmRFdmVudCA9IHtcbiAgdHlwZTogJ2dpem1vRHJhZ0VuZGVkJ1xuICB0cmFuc2Zvcm1zOiBBcnJheTx7XG4gICAgcG9zaXRpb246IFZlY3RvcjNUeXBlXG4gICAgcm90YXRpb246IFF1YXRlcm5pb25UeXBlXG4gICAgc2NhbGU6IFZlY3RvcjNUeXBlXG4gICAgZW50aXR5SWQ6IHVua25vd25cbiAgfT5cbn1cblxuLyoqIEBwdWJsaWMgKi9cbmV4cG9ydCB0eXBlIEdpem1vU2VsZWN0ZWRFdmVudCA9IHtcbiAgdHlwZTogJ2dpem1vU2VsZWN0ZWQnXG4gIGdpem1vVHlwZTogJ01PVkUnIHwgJ1JPVEFURScgfCAnU0NBTEUnIHwgJ05PTkUnXG4gIGVudGl0aWVzOiBzdHJpbmdbXVxufVxuXG4vLy8gLS0tIEVWRU5UUyAtLS1cblxuLyoqIEBwdWJsaWMgKi9cbmV4cG9ydCB0eXBlIElFdmVudE5hbWVzID0ga2V5b2YgSUV2ZW50c1xuXG4vKiogQHB1YmxpYyAqL1xuZXhwb3J0IHR5cGUgRW5naW5lRXZlbnQ8VCBleHRlbmRzIElFdmVudE5hbWVzID0gSUV2ZW50TmFtZXMsIFYgPSBJRXZlbnRzW1RdPiA9IHtcbiAgLyoqIGV2ZW50TmFtZSAqL1xuICB0eXBlOiBUXG4gIGRhdGE6IFJlYWRvbmx5PFY+XG59XG5cbi8qKlxuICogQHB1YmxpY1xuICogTm90ZTogRG9uJ3QgdXNlIGBvbmAgcHJlZml4IGZvciBJRXZlbnRzIHRvIGF2b2lkIHJlZHVuZGFuY3kgd2l0aCBgZXZlbnQub24oXCJvbkV2ZW50TmFtZVwiKWAgc3ludGF4LlxuICovXG5leHBvcnQgaW50ZXJmYWNlIElFdmVudHMge1xuICAvKipcbiAgICogYHBvc2l0aW9uQ2hhbmdlZGAgaXMgdHJpZ2dlcmVkIHdoZW4gdGhlIHBvc2l0aW9uIG9mIHRoZSBjYW1lcmEgY2hhbmdlc1xuICAgKiBUaGlzIGV2ZW50IGlzIHRocm90dGxlZCB0byAxMCB0aW1lcyBwZXIgc2Vjb25kLlxuICAgKi9cbiAgcG9zaXRpb25DaGFuZ2VkOiB7XG4gICAgLyoqIENhbWVyYSBwb3NpdGlvbiByZWxhdGl2ZSB0byB0aGUgYmFzZSBwYXJjZWwgb2YgdGhlIHNjZW5lICovXG4gICAgcG9zaXRpb246IFZlY3RvcjNUeXBlXG5cbiAgICAvKiogQ2FtZXJhIHBvc2l0aW9uLCB0aGlzIGlzIGEgYWJzb2x1dGUgd29ybGQgcG9zaXRpb24gKi9cbiAgICBjYW1lcmFQb3NpdGlvbjogVmVjdG9yM1R5cGVcblxuICAgIC8qKiBFeWUgaGVpZ2h0LCBpbiBtZXRlcnMuICovXG4gICAgcGxheWVySGVpZ2h0OiBudW1iZXJcbiAgfVxuXG4gIC8qKlxuICAgKiBgcm90YXRpb25DaGFuZ2VkYCBpcyB0cmlnZ2VyZWQgd2hlbiB0aGUgcm90YXRpb24gb2YgdGhlIGNhbWVyYSBjaGFuZ2VzLlxuICAgKiBUaGlzIGV2ZW50IGlzIHRocm90dGxlZCB0byAxMCB0aW1lcyBwZXIgc2Vjb25kLlxuICAgKi9cbiAgcm90YXRpb25DaGFuZ2VkOiB7XG4gICAgLyoqIERlZ3JlZSB2ZWN0b3IuIFNhbWUgYXMgZW50aXRpZXMgKi9cbiAgICByb3RhdGlvbjogVmVjdG9yM1R5cGVcbiAgICAvKiogUm90YXRpb24gcXVhdGVybmlvbiwgdXNlZnVsIGluIHNvbWUgc2NlbmFyaW9zLiAqL1xuICAgIHF1YXRlcm5pb246IFF1YXRlcm5pb25UeXBlXG4gIH1cblxuICAvKipcbiAgICogYGNhbWVyYU1vZGVDaGFuZ2VkYCBpcyB0cmlnZ2VyZWQgd2hlbiB0aGUgdXNlciBjaGFuZ2VzIHRoZSBjYW1lcmEgbW9kZVxuICAgKi9cbiAgY2FtZXJhTW9kZUNoYW5nZWQ6IHtcbiAgICAvKipcbiAgICAgKiBGSVJTVF9QRVJTT04gPSAwLFxuICAgICAqIFRISVJEX1BFUlNPTiA9IDEsXG4gICAgICogRlJFRV9DQU1FUkEgPSAyXG4gICAgICovXG4gICAgY2FtZXJhTW9kZTogMCB8IDEgfCAyXG4gIH1cblxuICAvKipcbiAgICogYGlkbGVTdGF0ZUNoYW5nZWRgIGlzIHRyaWdnZXJlZCB3aGVuIHRoZSB1c2VyIG5vdCBtb3ZlcyBmb3IgYSBkZWZpbmVkIHBlcmlvZCBvZiB0aW1lXG4gICAqL1xuICBpZGxlU3RhdGVDaGFuZ2VkOiB7XG4gICAgaXNJZGxlOiBib29sZWFuXG4gIH1cblxuICBwbGF5ZXJFeHByZXNzaW9uOiB7XG4gICAgZXhwcmVzc2lvbklkOiBzdHJpbmdcbiAgfVxuXG4gIC8qKlxuICAgKiBgcG9pbnRlclVwYCBpcyB0cmlnZ2VyZWQgd2hlbiB0aGUgdXNlciByZWxlYXNlcyBhbiBpbnB1dCBwb2ludGVyLlxuICAgKiBJdCBjb3VsZCBiZSBhIFZSIGNvbnRyb2xsZXIsIGEgdG91Y2ggc2NyZWVuIG9yIHRoZSBtb3VzZS5cbiAgICovXG4gIHBvaW50ZXJVcDogSW5wdXRFdmVudFJlc3VsdFxuXG4gIC8qKlxuICAgKiBgcG9pbnRlckRvd25gIGlzIHRyaWdnZXJlZCB3aGVuIHRoZSB1c2VyIHByZXNzIGFuIGlucHV0IHBvaW50ZXIuXG4gICAqIEl0IGNvdWxkIGJlIGEgVlIgY29udHJvbGxlciwgYSB0b3VjaCBzY3JlZW4gb3IgdGhlIG1vdXNlLlxuICAgKi9cbiAgcG9pbnRlckRvd246IElucHV0RXZlbnRSZXN1bHRcblxuICAvKipcbiAgICogYHBvaW50ZXJFdmVudGAgaXMgdHJpZ2dlcmVkIHdoZW4gdGhlIHVzZXIgcHJlc3Mgb3IgcmVsZWFzZXMgYW4gaW5wdXQgcG9pbnRlci5cbiAgICogSXQgY291bGQgYmUgYSBWUiBjb250cm9sbGVyLCBhIHRvdWNoIHNjcmVlbiBvciB0aGUgbW91c2UuXG4gICAqXG4gICAqIEBkZXByZWNhdGVkIHVzZSBhY3Rpb25CdXR0b25FdmVudCBpbnN0ZWFkXG4gICAqL1xuICBwb2ludGVyRXZlbnQ6IEdsb2JhbElucHV0RXZlbnRSZXN1bHRcblxuICAvKipcbiAgICogYGFjdGlvbkJ1dHRvbkV2ZW50YCBpcyB0cmlnZ2VyZWQgd2hlbiB0aGUgdXNlciBwcmVzcyBvciByZWxlYXNlcyBhbiBpbnB1dCBwb2ludGVyLlxuICAgKiBJdCBjb3VsZCBiZSBhIFZSIGNvbnRyb2xsZXIsIGEgdG91Y2ggc2NyZWVuIG9yIHRoZSBtb3VzZS5cbiAgICpcbiAgICogVGhpcyBldmVudCBpcyBleGFjdGx5IHRoZSBzYW1lIGFzIGBwb2ludGVyRXZlbnRgIGJ1dCB0aGUgbG9naWMgaW4gdGhlIEVDUyBoYWQgYW4gdW5zb2x2YWJsZVxuICAgKiBjb25kaXRpb24gdGhhdCByZXF1aXJlZCB1cyB0byBjcmVhdGUgdGhpcyBuZXcgZXZlbnQgdG8gaGFuZGxlIG1vcmUgY2FzZXMgZm9yIG5ldyBidXR0b25zLlxuICAgKi9cbiAgYWN0aW9uQnV0dG9uRXZlbnQ6IEdsb2JhbElucHV0RXZlbnRSZXN1bHRcblxuICAvKipcbiAgICogYHJheWNhc3RSZXNwb25zZWAgaXMgdHJpZ2dlcmVkIGluIHJlc3BvbnNlIHRvIGEgcmF5Y2FzdCBxdWVyeVxuICAgKi9cbiAgcmF5Y2FzdFJlc3BvbnNlOiBSYXljYXN0UmVzcG9uc2VQYXlsb2FkPGFueT5cblxuICAvKipcbiAgICogYGNoYXRNZXNzYWdlYCBpcyB0cmlnZ2VyZWQgd2hlbiB0aGUgdXNlciBzZW5kcyBhIG1lc3NhZ2UgdGhyb3VnaCBjaGF0IGVudGl0eS5cbiAgICovXG4gIGNoYXRNZXNzYWdlOiB7XG4gICAgaWQ6IHN0cmluZ1xuICAgIHNlbmRlcjogc3RyaW5nXG4gICAgbWVzc2FnZTogc3RyaW5nXG4gICAgaXNDb21tYW5kOiBib29sZWFuXG4gIH1cblxuICAvKipcbiAgICogYG9uQ2hhbmdlYCBpcyB0cmlnZ2VyZWQgd2hlbiBhbiBlbnRpdHkgY2hhbmdlcyBpdHMgb3duIGludGVybmFsIHN0YXRlLlxuICAgKiBEaXNwYXRjaGVkIGJ5IHRoZSBgdWktKmAgZW50aXRpZXMgd2hlbiB0aGVpciB2YWx1ZSBpcyBjaGFuZ2VkLiBJdCB0cmlnZ2VycyBhIGNhbGxiYWNrLlxuICAgKiBOb3RpY2U6IE9ubHkgZW50aXRpZXMgd2l0aCBJRCB3aWxsIGJlIGxpc3RlbmluZyBmb3IgY2xpY2sgZXZlbnRzLlxuICAgKi9cbiAgb25DaGFuZ2U6IHtcbiAgICB2YWx1ZT86IGFueVxuICAgIC8qKiBJRCBvZiB0aGUgcG9pbnRlciB0aGF0IHRyaWdnZXJlZCB0aGUgZXZlbnQgKi9cbiAgICBwb2ludGVySWQ/OiBudW1iZXJcbiAgfVxuXG4gIC8qKlxuICAgKiBgb25FbnRlcmAgaXMgdHJpZ2dlcmVkIHdoZW4gdGhlIHVzZXIgaGl0cyB0aGUgXCJFbnRlclwiIGtleSBmcm9tIHRoZSBrZXlib2FyZFxuICAgKiBVc2VkIHByaW5jaXBhbGx5IGJ5IHRoZSBDaGF0IGludGVybmFsIHNjZW5lXG4gICAqL1xuICBvbkVudGVyOiB1bmtub3duXG5cbiAgLyoqXG4gICAqIGBvblBvaW50ZXJMb2NrYCBpcyB0cmlnZ2VyZWQgd2hlbiB0aGUgdXNlciBjbGlja3MgdGhlIHdvcmxkIGNhbnZhcyBhbmQgdGhlXG4gICAqIHBvaW50ZXIgbG9ja3MgdG8gaXQgc28gdGhlIHBvaW50ZXIgbW92ZXMgdGhlIGNhbWVyYVxuICAgKi9cbiAgb25Qb2ludGVyTG9jazoge1xuICAgIGxvY2tlZD86IGJvb2xlYW5cbiAgfVxuXG4gIC8qKlxuICAgKiBgb25BbmltYXRpb25FbmRgIGlzIHRyaWdnZXJlZCB3aGVuIGFuIGFuaW1hdGlvbiBjbGlwIGdldHMgZmluaXNoXG4gICAqL1xuICBvbkFuaW1hdGlvbkVuZDoge1xuICAgIGNsaXBOYW1lOiBzdHJpbmdcbiAgfVxuXG4gIC8qKlxuICAgKiBgb25Gb2N1c2AgaXMgdHJpZ2dlcmVkIHdoZW4gYW4gZW50aXR5IGZvY3VzIGlzIGFjdGl2ZS5cbiAgICogRGlzcGF0Y2hlZCBieSB0aGUgYHVpLWlucHV0YCBhbmQgYHVpLXBhc3N3b3JkYCBlbnRpdGllcyB3aGVuIHRoZSB2YWx1ZSBpcyBjaGFuZ2VkLlxuICAgKiBJdCB0cmlnZ2VycyBhIGNhbGxiYWNrLlxuICAgKlxuICAgKiBOb3RpY2U6IE9ubHkgZW50aXRpZXMgd2l0aCBJRCB3aWxsIGJlIGxpc3RlbmluZyBmb3IgY2xpY2sgZXZlbnRzLlxuICAgKi9cbiAgb25Gb2N1czoge1xuICAgIC8qKiBJRCBvZiB0aGUgZW50aXRpeSBvZiB0aGUgZXZlbnQgKi9cbiAgICBlbnRpdHlJZDogdW5rbm93blxuICAgIC8qKiBJRCBvZiB0aGUgcG9pbnRlciB0aGF0IHRyaWdnZXJlZCB0aGUgZXZlbnQgKi9cbiAgICBwb2ludGVySWQ6IG51bWJlclxuICB9XG5cbiAgLyoqXG4gICAqIGBvbkJsdXJgIGlzIHRyaWdnZXJlZCB3aGVuIGFuIGVudGl0eSBsb3NlcyBpdHMgZm9jdXMuXG4gICAqIERpc3BhdGNoZWQgYnkgdGhlIGB1aS1pbnB1dGAgYW5kIGB1aS1wYXNzd29yZGAgZW50aXRpZXMgd2hlbiB0aGUgdmFsdWUgaXMgY2hhbmdlZC5cbiAgICogIEl0IHRyaWdnZXJzIGEgY2FsbGJhY2suXG4gICAqXG4gICAqIE5vdGljZTogT25seSBlbnRpdGllcyB3aXRoIElEIHdpbGwgYmUgbGlzdGVuaW5nIGZvciBjbGljayBldmVudHMuXG4gICAqL1xuICBvbkJsdXI6IHtcbiAgICAvKiogSUQgb2YgdGhlIGVudGl0aXkgb2YgdGhlIGV2ZW50ICovXG4gICAgZW50aXR5SWQ6IHVua25vd25cbiAgICAvKiogSUQgb2YgdGhlIHBvaW50ZXIgdGhhdCB0cmlnZ2VyZWQgdGhlIGV2ZW50ICovXG4gICAgcG9pbnRlcklkOiBudW1iZXJcbiAgfVxuXG4gIC8qKiBUaGUgb25DbGljayBldmVudCBpcyBvbmx5IHVzZWQgZm9yIFVJIGVsZW1lbnRzICovXG4gIG9uQ2xpY2s6IHtcbiAgICBlbnRpdHlJZDogdW5rbm93blxuICB9XG5cbiAgLyoqXG4gICAqIFRoaXMgZXZlbnQgZ2V0cyB0cmlnZ2VyZWQgd2hlbiBhbiBlbnRpdHkgbGVhdmVzIHRoZSBzY2VuZSBmZW5jZXMuXG4gICAqL1xuICBlbnRpdHlPdXRPZlNjZW5lOiB7XG4gICAgZW50aXR5SWQ6IHVua25vd25cbiAgfVxuXG4gIC8qKlxuICAgKiBUaGlzIGV2ZW50IGdldHMgdHJpZ2dlcmVkIHdoZW4gYW4gZW50aXR5IGVudGVycyB0aGUgc2NlbmUgZmVuY2VzLlxuICAgKi9cbiAgZW50aXR5QmFja0luU2NlbmU6IHtcbiAgICBlbnRpdHlJZDogdW5rbm93blxuICB9XG5cbiAgLyoqXG4gICAqIFRoaXMgZXZlbnQgZ2V0cyB0cmlnZ2VyZWQgd2hlbiB0aGUgdXNlciBlbnRlcnMgdGhlIHNjZW5lXG4gICAqL1xuICBvbkVudGVyU2NlbmU6IHtcbiAgICB1c2VySWQ6IHN0cmluZ1xuICB9XG5cbiAgLyoqXG4gICAqIFRoaXMgZXZlbnQgZ2V0cyB0cmlnZ2VyZWQgd2hlbiB0aGUgdXNlciBsZWF2ZXMgdGhlIHNjZW5lXG4gICAqL1xuICBvbkxlYXZlU2NlbmU6IHtcbiAgICB1c2VySWQ6IHN0cmluZ1xuICB9XG5cbiAgLyoqXG4gICAqIFRoaXMgZXZlbnQgZ2V0cyB0cmlnZ2VyZWQgYWZ0ZXIgcmVjZWl2aW5nIGEgY29tbXMgbWVzc2FnZS5cbiAgICovXG4gIGNvbW1zOiB7XG4gICAgc2VuZGVyOiBzdHJpbmdcbiAgICBtZXNzYWdlOiBzdHJpbmdcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGlzIGlzIHRyaWdnZXJlZCBvbmNlIHRoZSBzY2VuZSBzaG91bGQgc3RhcnQuXG4gICAqL1xuICBzY2VuZVN0YXJ0OiB1bmtub3duXG5cbiAgLyoqXG4gICAqIFRoaXMgaXMgdHJpZ2dlcmVkIG9uY2UgdGhlIGJ1aWxkZXIgc2NlbmUgaXMgbG9hZGVkLlxuICAgKi9cbiAgYnVpbGRlclNjZW5lU3RhcnQ6IHVua25vd25cblxuICAvKipcbiAgICogVGhpcyBpcyB0cmlnZ2VyZWQgb25jZSB0aGUgYnVpbGRlciBzY2VuZSBpcyB1bmxvYWRlZC5cbiAgICovXG4gIGJ1aWxkZXJTY2VuZVVubG9hZGVkOiB1bmtub3duXG5cbiAgLyoqXG4gICAqIEFmdGVyIGNoZWNraW5nIGVudGl0aWVzIG91dHNpZGUgdGhlIGZlbmNlcywgaWYgYW55IGlzIG91dHNpZGUsIHRoaXMgZXZlbnRcbiAgICogd2lsbCBiZSB0cmlnZ2VyZWQgd2l0aCBhbGwgdGhlIGVudGl0aWVzIG91dHNpZGUgdGhlIHNjZW5lLlxuICAgKi9cbiAgZW50aXRpZXNPdXRPZkJvdW5kYXJpZXM6IHtcbiAgICBlbnRpdGllczogc3RyaW5nW11cbiAgfVxuXG4gIHV1aWRFdmVudDoge1xuICAgIHV1aWQ6IHN0cmluZ1xuICAgIHBheWxvYWQ6IGFueVxuICB9XG5cbiAgb25UZXh0U3VibWl0OiB7XG4gICAgdGV4dDogc3RyaW5nXG4gIH1cblxuICBtZXRyaWNzVXBkYXRlOiB7XG4gICAgZ2l2ZW46IFJlY29yZDxzdHJpbmcsIG51bWJlcj5cbiAgICBsaW1pdDogUmVjb3JkPHN0cmluZywgbnVtYmVyPlxuICB9XG5cbiAgbGltaXRzRXhjZWVkZWQ6IHtcbiAgICBnaXZlbjogUmVjb3JkPHN0cmluZywgbnVtYmVyPlxuICAgIGxpbWl0OiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+XG4gIH1cblxuICAvKiogRm9yIGdpem1vcyAqL1xuICBnaXptb0V2ZW50OiBHaXptb0RyYWdFbmRFdmVudCB8IEdpem1vU2VsZWN0ZWRFdmVudFxuXG4gIGV4dGVybmFsQWN0aW9uOiB7XG4gICAgdHlwZTogc3RyaW5nXG4gICAgW2tleTogc3RyaW5nXTogYW55XG4gIH1cblxuICBzdGF0ZUV2ZW50OiB7XG4gICAgdHlwZTogc3RyaW5nXG4gICAgcGF5bG9hZDogYW55XG4gIH1cblxuICAvKiogVGhpcyBpcyB0cmlnZ2VyZWQgYXQgbGVhc3QgZm9yIGVhY2ggdmlkZW9TdGF0dXMgY2hhbmdlICovXG4gIHZpZGVvRXZlbnQ6IHtcbiAgICBjb21wb25lbnRJZDogc3RyaW5nXG4gICAgdmlkZW9DbGlwSWQ6IHN0cmluZ1xuICAgIC8qKiBTdGF0dXMsIGNhbiBiZSBOT05FID0gMCwgRVJST1IgPSAxLCBMT0FESU5HID0gMiwgUkVBRFkgPSAzLCBQTEFZSU5HID0gNCxCVUZGRVJJTkcgPSA1ICovXG4gICAgdmlkZW9TdGF0dXM6IG51bWJlclxuICAgIC8qKiBDdXJyZW50IG9mZnNldCBwb3NpdGlvbiBpbiBzZWNvbmRzICovXG4gICAgY3VycmVudE9mZnNldDogbnVtYmVyXG4gICAgLyoqIFZpZGVvIGxlbmd0aCBpbiBzZWNvbmRzLiBDYW4gYmUgLTEgKi9cbiAgICB0b3RhbFZpZGVvTGVuZ3RoOiBudW1iZXJcbiAgfVxuXG4gIC8qKiBUaGlzIGlzIHRyaWdnZXIgZXZlcnl0aW1lIGEgcHJvZmlsZSBpcyBjaGFuZ2VkICovXG4gIHByb2ZpbGVDaGFuZ2VkOiB7XG4gICAgZXRoQWRkcmVzczogc3RyaW5nXG4gICAgdmVyc2lvbjogbnVtYmVyXG4gIH1cblxuICAvKiogVHJpZ2dlcmVkIHdoZW4gcGVlcidzIGF2YXRhciBpcyBjb25uZWN0ZWQgYW5kIHZpc2libGUgKi9cbiAgcGxheWVyQ29ubmVjdGVkOiB7XG4gICAgdXNlcklkOiBzdHJpbmdcbiAgfVxuXG4gIC8qKiBUcmlnZ2VyZWQgd2hlbiBwZWVyIGRpc2Nvbm5lY3QgYW5kL29yIGl0IGF2YXRhciBpcyBzZXQgaW52aXNpYmxlIGJ5IGNvbW1zICovXG4gIHBsYXllckRpc2Nvbm5lY3RlZDoge1xuICAgIHVzZXJJZDogc3RyaW5nXG4gIH1cblxuICAvKiogVHJpZ2dlcmVkIHdoZW4gY3VycmVudCByZWFsbSBvciBpc2xhbmQgY2hhbmdlcyAqL1xuICBvblJlYWxtQ2hhbmdlZDoge1xuICAgIGRvbWFpbjogc3RyaW5nXG4gICAgcm9vbTogc3RyaW5nXG4gICAgc2VydmVyTmFtZTogc3RyaW5nXG4gICAgZGlzcGxheU5hbWU6IHN0cmluZ1xuICB9XG5cbiAgLyoqIFRyaWdnZXJlZCB3aGVuIG90aGVyIHBsYXllcidzIGF2YXRhciBpcyBjbGlja2VkICovXG4gIHBsYXllckNsaWNrZWQ6IHtcbiAgICB1c2VySWQ6IHN0cmluZ1xuICAgIHJheToge1xuICAgICAgb3JpZ2luOiBWZWN0b3IzVHlwZVxuICAgICAgZGlyZWN0aW9uOiBWZWN0b3IzVHlwZVxuICAgICAgZGlzdGFuY2U6IG51bWJlclxuICAgIH1cbiAgfVxuXG4gIC8qKiBUcmlnZ2VyZWQgd2hlbiBwb2ludGVyIHN0YXJ0IGhvdmVyaW5nIGFuIGVudGl0aWVzJyBzaGFwZSAqL1xuICBwb2ludGVySG92ZXJFbnRlcjogdW5rbm93blxuXG4gIC8qKiBUcmlnZ2VyZWQgd2hlbiBwb2ludGVyIHN0b3AgaG92ZXJpbmcgYW4gZW50aXRpZXMnIHNoYXBlICovXG4gIHBvaW50ZXJIb3ZlckV4aXQ6IHVua25vd25cbn1cblxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqIFRoaXMgZnVuY3Rpb24gZ2VuZXJhdGVzIGEgY2FsbGJhY2sgdGhhdCBpcyBwYXNzZWQgdG8gdGhlIE9ic2VydmFibGVcbiAqIGNvbnN0cnVjdG9yIHRvIHN1YnNjcmliZSB0byB0aGUgZXZlbnRzIG9mIHRoZSBEZWNlbnRyYWxhbmRJbnRlcmZhY2VcbiAqL1xuZnVuY3Rpb24gY3JlYXRlU3Vic2NyaWJlcihldmVudE5hbWU6IHN0cmluZykge1xuICByZXR1cm4gKCkgPT4ge1xuICAgIHN1YnNjcmliZUZ1bmN0aW9uKHsgZXZlbnRJZDogZXZlbnROYW1lIH0pLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gIH1cbn1cblxuLyoqXG4gKiBUaGVzZSBldmVudHMgYXJlIHRyaWdnZXJlZCBhZnRlciB5b3VyIGNoYXJhY3RlciBlbnRlcnMgdGhlIHNjZW5lLlxuICogQHB1YmxpY1xuICogQGRlcHJlY2F0ZWQgVGhpcyBmdW5jdGlvbiBpcyBhbiBpbmhlcml0YW5jZSBvZiBFQ1M2LCBpdCdzIGhlcmUgdGVtcG9yYXJ5IGZvciB0aGUgZmVhdHVyZSBwYXJpdHksIHBsZWFzZSByZWFkIHRoZSBuZXdzIGFuZCBkb2NzIHRvIGtub3cgaG93IGhhbmRsZSB3aGVuIGl0J3MgcmVtb3ZlZC5cbiAqL1xuZXhwb3J0IGNvbnN0IG9uRW50ZXJTY2VuZU9ic2VydmFibGUgPSBuZXcgT2JzZXJ2YWJsZTxJRXZlbnRzWydvbkVudGVyU2NlbmUnXT4oY3JlYXRlU3Vic2NyaWJlcignb25FbnRlclNjZW5lJykpXG4vKiogQHB1YmxpY1xuICogQGRlcHJlY2F0ZWQgVGhpcyBmdW5jdGlvbiBpcyBhbiBpbmhlcml0YW5jZSBvZiBFQ1M2LCBpdCdzIGhlcmUgdGVtcG9yYXJ5IGZvciB0aGUgZmVhdHVyZSBwYXJpdHksIHBsZWFzZSByZWFkIHRoZSBuZXdzIGFuZCBkb2NzIHRvIGtub3cgaG93IGhhbmRsZSB3aGVuIGl0J3MgcmVtb3ZlZC5cbiAqIEBkZXByZWNhdGVkIFRoaXMgZnVuY3Rpb24gaXMgYW4gaW5oZXJpdGFuY2Ugb2YgRUNTNiwgaXQncyBoZXJlIHRlbXBvcmFyeSBmb3IgdGhlIGZlYXR1cmUgcGFyaXR5LCBwbGVhc2UgcmVhZCB0aGUgbmV3cyBhbmQgZG9jcyB0byBrbm93IGhvdyBoYW5kbGUgd2hlbiBpdCdzIHJlbW92ZWQuIFVzZSBvbkVudGVyU2NlbmVPYnNlcnZhYmxlIGluc3RlYWQuICovXG5leHBvcnQgY29uc3Qgb25FbnRlclNjZW5lID0gb25FbnRlclNjZW5lT2JzZXJ2YWJsZVxuXG4vKipcbiAqIFRoZXNlIGV2ZW50cyBhcmUgdHJpZ2dlcmVkIGFmdGVyIHlvdXIgY2hhcmFjdGVyIGxlYXZlcyB0aGUgc2NlbmUuXG4gKiBAcHVibGljXG4gKiBAZGVwcmVjYXRlZCBUaGlzIGZ1bmN0aW9uIGlzIGFuIGluaGVyaXRhbmNlIG9mIEVDUzYsIGl0J3MgaGVyZSB0ZW1wb3JhcnkgZm9yIHRoZSBmZWF0dXJlIHBhcml0eSwgcGxlYXNlIHJlYWQgdGhlIG5ld3MgYW5kIGRvY3MgdG8ga25vdyBob3cgaGFuZGxlIHdoZW4gaXQncyByZW1vdmVkLlxuICovXG5leHBvcnQgY29uc3Qgb25MZWF2ZVNjZW5lT2JzZXJ2YWJsZSA9IG5ldyBPYnNlcnZhYmxlPElFdmVudHNbJ29uTGVhdmVTY2VuZSddPihjcmVhdGVTdWJzY3JpYmVyKCdvbkxlYXZlU2NlbmUnKSlcblxuLyoqIEBwdWJsaWNcbiAqIEBkZXByZWNhdGVkIFRoaXMgZnVuY3Rpb24gaXMgYW4gaW5oZXJpdGFuY2Ugb2YgRUNTNiwgaXQncyBoZXJlIHRlbXBvcmFyeSBmb3IgdGhlIGZlYXR1cmUgcGFyaXR5LCBwbGVhc2UgcmVhZCB0aGUgbmV3cyBhbmQgZG9jcyB0byBrbm93IGhvdyBoYW5kbGUgd2hlbiBpdCdzIHJlbW92ZWQuXG4gKiBAZGVwcmVjYXRlZCBUaGlzIGZ1bmN0aW9uIGlzIGFuIGluaGVyaXRhbmNlIG9mIEVDUzYsIGl0J3MgaGVyZSB0ZW1wb3JhcnkgZm9yIHRoZSBmZWF0dXJlIHBhcml0eSwgcGxlYXNlIHJlYWQgdGhlIG5ld3MgYW5kIGRvY3MgdG8ga25vdyBob3cgaGFuZGxlIHdoZW4gaXQncyByZW1vdmVkLiBVc2Ugb25MZWF2ZVNjZW5lT2JzZXJ2YWJsZSBpbnN0ZWFkLiAqL1xuZXhwb3J0IGNvbnN0IG9uTGVhdmVTY2VuZSA9IG9uTGVhdmVTY2VuZU9ic2VydmFibGVcblxuLyoqXG4gKiBUaGlzIGV2ZW50IGlzIHRyaWdnZXJlZCBhZnRlciBhbGwgdGhlIHJlc291cmNlcyBvZiB0aGUgc2NlbmUgd2VyZSBsb2FkZWQgKG1vZGVscywgdGV4dHVyZXMsIGV0Yy4uLilcbiAqIEBwdWJsaWNcbiAqIEBkZXByZWNhdGVkIFRoaXMgZnVuY3Rpb24gaXMgYW4gaW5oZXJpdGFuY2Ugb2YgRUNTNiwgaXQncyBoZXJlIHRlbXBvcmFyeSBmb3IgdGhlIGZlYXR1cmUgcGFyaXR5LCBwbGVhc2UgcmVhZCB0aGUgbmV3cyBhbmQgZG9jcyB0byBrbm93IGhvdyBoYW5kbGUgd2hlbiBpdCdzIHJlbW92ZWQuXG4gKi9cbmV4cG9ydCBjb25zdCBvblNjZW5lUmVhZHlPYnNlcnZhYmxlID0gbmV3IE9ic2VydmFibGU8SUV2ZW50c1snc2NlbmVTdGFydCddPihjcmVhdGVTdWJzY3JpYmVyKCdzY2VuZVN0YXJ0JykpXG5cbi8qKlxuICogQHB1YmxpY1xuICogQGRlcHJlY2F0ZWQgVGhpcyBmdW5jdGlvbiBpcyBhbiBpbmhlcml0YW5jZSBvZiBFQ1M2LCBpdCdzIGhlcmUgdGVtcG9yYXJ5IGZvciB0aGUgZmVhdHVyZSBwYXJpdHksIHBsZWFzZSByZWFkIHRoZSBuZXdzIGFuZCBkb2NzIHRvIGtub3cgaG93IGhhbmRsZSB3aGVuIGl0J3MgcmVtb3ZlZC5cbiAqL1xuZXhwb3J0IGNvbnN0IG9uUGxheWVyRXhwcmVzc2lvbk9ic2VydmFibGUgPSBuZXcgT2JzZXJ2YWJsZTxJRXZlbnRzWydwbGF5ZXJFeHByZXNzaW9uJ10+KFxuICBjcmVhdGVTdWJzY3JpYmVyKCdwbGF5ZXJFeHByZXNzaW9uJylcbilcblxuLyoqXG4gKiBAcHVibGljXG4gKiBAZGVwcmVjYXRlZCBUaGlzIGZ1bmN0aW9uIGlzIGFuIGluaGVyaXRhbmNlIG9mIEVDUzYsIGl0J3MgaGVyZSB0ZW1wb3JhcnkgZm9yIHRoZSBmZWF0dXJlIHBhcml0eSwgcGxlYXNlIHJlYWQgdGhlIG5ld3MgYW5kIGRvY3MgdG8ga25vdyBob3cgaGFuZGxlIHdoZW4gaXQncyByZW1vdmVkLlxuICovXG5leHBvcnQgY29uc3Qgb25WaWRlb0V2ZW50ID0gbmV3IE9ic2VydmFibGU8SUV2ZW50c1sndmlkZW9FdmVudCddPihjcmVhdGVTdWJzY3JpYmVyKCd2aWRlb0V2ZW50JykpXG5cbi8qKlxuICogQHB1YmxpY1xuICogQGRlcHJlY2F0ZWQgVGhpcyBmdW5jdGlvbiBpcyBhbiBpbmhlcml0YW5jZSBvZiBFQ1M2LCBpdCdzIGhlcmUgdGVtcG9yYXJ5IGZvciB0aGUgZmVhdHVyZSBwYXJpdHksIHBsZWFzZSByZWFkIHRoZSBuZXdzIGFuZCBkb2NzIHRvIGtub3cgaG93IGhhbmRsZSB3aGVuIGl0J3MgcmVtb3ZlZC5cbiAqL1xuZXhwb3J0IGNvbnN0IG9uUHJvZmlsZUNoYW5nZWQgPSBuZXcgT2JzZXJ2YWJsZTxJRXZlbnRzWydwcm9maWxlQ2hhbmdlZCddPihjcmVhdGVTdWJzY3JpYmVyKCdwcm9maWxlQ2hhbmdlZCcpKVxuXG4vKipcbiAqIEBwdWJsaWNcbiAqIEBkZXByZWNhdGVkIFRoaXMgZnVuY3Rpb24gaXMgYW4gaW5oZXJpdGFuY2Ugb2YgRUNTNiwgaXQncyBoZXJlIHRlbXBvcmFyeSBmb3IgdGhlIGZlYXR1cmUgcGFyaXR5LCBwbGVhc2UgcmVhZCB0aGUgbmV3cyBhbmQgZG9jcyB0byBrbm93IGhvdyBoYW5kbGUgd2hlbiBpdCdzIHJlbW92ZWQuXG4gKi9cbmV4cG9ydCBjb25zdCBvblBsYXllckNvbm5lY3RlZE9ic2VydmFibGUgPSBuZXcgT2JzZXJ2YWJsZTxJRXZlbnRzWydwbGF5ZXJDb25uZWN0ZWQnXT4oXG4gIGNyZWF0ZVN1YnNjcmliZXIoJ3BsYXllckNvbm5lY3RlZCcpXG4pXG5cbi8qKlxuICogQHB1YmxpY1xuICogQGRlcHJlY2F0ZWQgVGhpcyBmdW5jdGlvbiBpcyBhbiBpbmhlcml0YW5jZSBvZiBFQ1M2LCBpdCdzIGhlcmUgdGVtcG9yYXJ5IGZvciB0aGUgZmVhdHVyZSBwYXJpdHksIHBsZWFzZSByZWFkIHRoZSBuZXdzIGFuZCBkb2NzIHRvIGtub3cgaG93IGhhbmRsZSB3aGVuIGl0J3MgcmVtb3ZlZC5cbiAqL1xuZXhwb3J0IGNvbnN0IG9uUGxheWVyRGlzY29ubmVjdGVkT2JzZXJ2YWJsZSA9IG5ldyBPYnNlcnZhYmxlPElFdmVudHNbJ3BsYXllckRpc2Nvbm5lY3RlZCddPihcbiAgY3JlYXRlU3Vic2NyaWJlcigncGxheWVyRGlzY29ubmVjdGVkJylcbilcblxuLyoqXG4gKiBAcHVibGljXG4gKiBAZGVwcmVjYXRlZCBUaGlzIGZ1bmN0aW9uIGlzIGFuIGluaGVyaXRhbmNlIG9mIEVDUzYsIGl0J3MgaGVyZSB0ZW1wb3JhcnkgZm9yIHRoZSBmZWF0dXJlIHBhcml0eSwgcGxlYXNlIHJlYWQgdGhlIG5ld3MgYW5kIGRvY3MgdG8ga25vdyBob3cgaGFuZGxlIHdoZW4gaXQncyByZW1vdmVkLlxuICovXG5leHBvcnQgY29uc3Qgb25SZWFsbUNoYW5nZWRPYnNlcnZhYmxlID0gbmV3IE9ic2VydmFibGU8SUV2ZW50c1snb25SZWFsbUNoYW5nZWQnXT4oY3JlYXRlU3Vic2NyaWJlcignb25SZWFsbUNoYW5nZWQnKSlcblxuLyoqXG4gKiBAcHVibGljXG4gKiBAZGVwcmVjYXRlZCBUaGlzIGZ1bmN0aW9uIGlzIGFuIGluaGVyaXRhbmNlIG9mIEVDUzYsIGl0J3MgaGVyZSB0ZW1wb3JhcnkgZm9yIHRoZSBmZWF0dXJlIHBhcml0eSwgcGxlYXNlIHJlYWQgdGhlIG5ld3MgYW5kIGRvY3MgdG8ga25vdyBob3cgaGFuZGxlIHdoZW4gaXQncyByZW1vdmVkLlxuICovXG5leHBvcnQgY29uc3Qgb25QbGF5ZXJDbGlja2VkT2JzZXJ2YWJsZSA9IG5ldyBPYnNlcnZhYmxlPElFdmVudHNbJ3BsYXllckNsaWNrZWQnXT4oY3JlYXRlU3Vic2NyaWJlcigncGxheWVyQ2xpY2tlZCcpKVxuXG4vKipcbiAqIEBpbnRlcm5hbFxuICogQGRlcHJlY2F0ZWQgVGhpcyBmdW5jdGlvbiBpcyBhbiBpbmhlcml0YW5jZSBvZiBFQ1M2LCBpdCdzIGhlcmUgdGVtcG9yYXJ5IGZvciB0aGUgZmVhdHVyZSBwYXJpdHksIHBsZWFzZSByZWFkIHRoZSBuZXdzIGFuZCBkb2NzIHRvIGtub3cgaG93IGhhbmRsZSB3aGVuIGl0J3MgcmVtb3ZlZC5cbiAqL1xuZXhwb3J0IGNvbnN0IG9uQ29tbXNNZXNzYWdlID0gbmV3IE9ic2VydmFibGU8SUV2ZW50c1snY29tbXMnXT4oY3JlYXRlU3Vic2NyaWJlcignY29tbXMnKSlcblxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqIFVzZWQgZm9yIHRlc3RpbmcgcHVycG9zZVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0U3Vic2NyaWJlRnVuY3Rpb24oZm46IChldmVudDogeyBldmVudElkOiBzdHJpbmcgfSkgPT4gUHJvbWlzZTxhbnk+KSB7XG4gIHN1YnNjcmliZUZ1bmN0aW9uID0gZm5cbn1cblxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqIEBkZXByZWNhdGVkIHRoaXMgaXMgYW4gT0xEIEFQSS5cbiAqIFRoaXMgZnVuY3Rpb24gdXNlcyB0aGUgU0RLNiBzZW5kQmF0Y2ggdG8gcG9sbCBldmVudHMgZnJvbSB0aGUgcmVuZGVyZXJcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHBvbGxFdmVudHMoc2VuZEJhdGNoOiAoYm9keTogTWFueUVudGl0eUFjdGlvbikgPT4gUHJvbWlzZTxTZW5kQmF0Y2hSZXNwb25zZT4pIHtcbiAgY29uc3QgeyBldmVudHMgfSA9IGF3YWl0IHNlbmRCYXRjaCh7IGFjdGlvbnM6IFtdIH0pXG4gIGZvciAoY29uc3QgZSBvZiBldmVudHMpIHtcbiAgICBpZiAoZS5nZW5lcmljKSB7XG4gICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShlLmdlbmVyaWMuZXZlbnREYXRhKVxuICAgICAgc3dpdGNoIChlLmdlbmVyaWMuZXZlbnRJZCkge1xuICAgICAgICBjYXNlICdvbkVudGVyU2NlbmUnOiB7XG4gICAgICAgICAgb25FbnRlclNjZW5lT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZGF0YSBhcyBJRXZlbnRzWydvbkVudGVyU2NlbmUnXSlcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ29uTGVhdmVTY2VuZSc6IHtcbiAgICAgICAgICBvbkxlYXZlU2NlbmVPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhkYXRhIGFzIElFdmVudHNbJ29uTGVhdmVTY2VuZSddKVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAnc2NlbmVTdGFydCc6IHtcbiAgICAgICAgICBvblNjZW5lUmVhZHlPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhkYXRhIGFzIElFdmVudHNbJ3NjZW5lU3RhcnQnXSlcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ3BsYXllckV4cHJlc3Npb24nOiB7XG4gICAgICAgICAgb25QbGF5ZXJFeHByZXNzaW9uT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZGF0YSBhcyBJRXZlbnRzWydwbGF5ZXJFeHByZXNzaW9uJ10pXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgICAgICBjYXNlICd2aWRlb0V2ZW50Jzoge1xuICAgICAgICAgIGNvbnN0IHZpZGVvRGF0YSA9IGRhdGEgYXMgSUV2ZW50c1sndmlkZW9FdmVudCddXG4gICAgICAgICAgb25WaWRlb0V2ZW50Lm5vdGlmeU9ic2VydmVycyh2aWRlb0RhdGEpXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgICAgICBjYXNlICdwcm9maWxlQ2hhbmdlZCc6IHtcbiAgICAgICAgICBvblByb2ZpbGVDaGFuZ2VkLm5vdGlmeU9ic2VydmVycyhkYXRhIGFzIElFdmVudHNbJ3Byb2ZpbGVDaGFuZ2VkJ10pXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgICAgICBjYXNlICdwbGF5ZXJDb25uZWN0ZWQnOiB7XG4gICAgICAgICAgb25QbGF5ZXJDb25uZWN0ZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhkYXRhIGFzIElFdmVudHNbJ3BsYXllckNvbm5lY3RlZCddKVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAncGxheWVyRGlzY29ubmVjdGVkJzoge1xuICAgICAgICAgIG9uUGxheWVyRGlzY29ubmVjdGVkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZGF0YSBhcyBJRXZlbnRzWydwbGF5ZXJEaXNjb25uZWN0ZWQnXSlcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ29uUmVhbG1DaGFuZ2VkJzoge1xuICAgICAgICAgIG9uUmVhbG1DaGFuZ2VkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZGF0YSBhcyBJRXZlbnRzWydvblJlYWxtQ2hhbmdlZCddKVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAncGxheWVyQ2xpY2tlZCc6IHtcbiAgICAgICAgICBvblBsYXllckNsaWNrZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhkYXRhIGFzIElFdmVudHNbJ3BsYXllckNsaWNrZWQnXSlcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ2NvbW1zJzoge1xuICAgICAgICAgIG9uQ29tbXNNZXNzYWdlLm5vdGlmeU9ic2VydmVycyhkYXRhIGFzIElFdmVudHNbJ2NvbW1zJ10pXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl19