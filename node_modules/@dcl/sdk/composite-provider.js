import { compositeFromLoader } from '~sdk/all-composites';
import { Composite } from '@dcl/ecs';
const composites = [];
export const compositeProvider = {
    getCompositeOrNull(src, _currentPath) {
        const fromLoader = compositeFromLoader[src];
        if (fromLoader) {
            try {
                if (fromLoader instanceof Uint8Array) {
                    const composite = Composite.fromBinary(fromLoader);
                    composites.push({ src, composite });
                }
                else if (typeof fromLoader === 'string') {
                    const composite = Composite.fromJson(JSON.parse(fromLoader));
                    composites.push({ src, composite });
                }
                else if (typeof fromLoader === 'object') {
                    const composite = Composite.fromJson(fromLoader);
                    composites.push({ src, composite });
                }
            }
            catch (err) {
                console.error(err);
            }
            delete compositeFromLoader[src];
        }
        return composites.find((item) => item.src === src) || null;
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9zaXRlLXByb3ZpZGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsic3JjL2NvbXBvc2l0ZS1wcm92aWRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQTtBQUN6RCxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sVUFBVSxDQUFBO0FBRXBDLE1BQU0sVUFBVSxHQUF5QixFQUFFLENBQUE7QUFHM0MsTUFBTSxDQUFDLE1BQU0saUJBQWlCLEdBQXVCO0lBQ25ELGtCQUFrQixDQUFDLEdBQVcsRUFBRSxZQUFxQjtRQUduRCxNQUFNLFVBQVUsR0FBRyxtQkFBbUIsQ0FBQyxHQUFHLENBQUMsQ0FBQTtRQUMzQyxJQUFJLFVBQVUsRUFBRTtZQUNkLElBQUk7Z0JBQ0YsSUFBSSxVQUFVLFlBQVksVUFBVSxFQUFFO29CQUNwQyxNQUFNLFNBQVMsR0FBRyxTQUFTLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxDQUFBO29CQUNsRCxVQUFVLENBQUMsSUFBSSxDQUFDLEVBQUUsR0FBRyxFQUFFLFNBQVMsRUFBRSxDQUFDLENBQUE7aUJBQ3BDO3FCQUFNLElBQUksT0FBTyxVQUFVLEtBQUssUUFBUSxFQUFFO29CQUN6QyxNQUFNLFNBQVMsR0FBRyxTQUFTLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQTtvQkFDNUQsVUFBVSxDQUFDLElBQUksQ0FBQyxFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsQ0FBQyxDQUFBO2lCQUNwQztxQkFBTSxJQUFJLE9BQU8sVUFBVSxLQUFLLFFBQVEsRUFBRTtvQkFDekMsTUFBTSxTQUFTLEdBQUcsU0FBUyxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsQ0FBQTtvQkFDaEQsVUFBVSxDQUFDLElBQUksQ0FBQyxFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsQ0FBQyxDQUFBO2lCQUNwQzthQUNGO1lBQUMsT0FBTyxHQUFHLEVBQUU7Z0JBQ1osT0FBTyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQTthQUNuQjtZQUVELE9BQU8sbUJBQW1CLENBQUMsR0FBRyxDQUFDLENBQUE7U0FDaEM7UUFFRCxPQUFPLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxHQUFHLEtBQUssR0FBRyxDQUFDLElBQUksSUFBSSxDQUFBO0lBQzVELENBQUM7Q0FDRixDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY29tcG9zaXRlRnJvbUxvYWRlciB9IGZyb20gJ35zZGsvYWxsLWNvbXBvc2l0ZXMnXG5pbXBvcnQgeyBDb21wb3NpdGUgfSBmcm9tICdAZGNsL2VjcydcblxuY29uc3QgY29tcG9zaXRlczogQ29tcG9zaXRlLlJlc291cmNlW10gPSBbXVxuXG4vLyBAcHVibGljXG5leHBvcnQgY29uc3QgY29tcG9zaXRlUHJvdmlkZXI6IENvbXBvc2l0ZS5Qcm92aWRlciA9IHtcbiAgZ2V0Q29tcG9zaXRlT3JOdWxsKHNyYzogc3RyaW5nLCBfY3VycmVudFBhdGg/OiBzdHJpbmcpIHtcbiAgICAvLyBUT0RPOiByZXNvbHZlIHBhdGggZnJvbSBzcmMgYW5kIGN1cnJlbnRQYXRoXG5cbiAgICBjb25zdCBmcm9tTG9hZGVyID0gY29tcG9zaXRlRnJvbUxvYWRlcltzcmNdXG4gICAgaWYgKGZyb21Mb2FkZXIpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmIChmcm9tTG9hZGVyIGluc3RhbmNlb2YgVWludDhBcnJheSkge1xuICAgICAgICAgIGNvbnN0IGNvbXBvc2l0ZSA9IENvbXBvc2l0ZS5mcm9tQmluYXJ5KGZyb21Mb2FkZXIpXG4gICAgICAgICAgY29tcG9zaXRlcy5wdXNoKHsgc3JjLCBjb21wb3NpdGUgfSlcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZnJvbUxvYWRlciA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICBjb25zdCBjb21wb3NpdGUgPSBDb21wb3NpdGUuZnJvbUpzb24oSlNPTi5wYXJzZShmcm9tTG9hZGVyKSlcbiAgICAgICAgICBjb21wb3NpdGVzLnB1c2goeyBzcmMsIGNvbXBvc2l0ZSB9KVxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBmcm9tTG9hZGVyID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgIGNvbnN0IGNvbXBvc2l0ZSA9IENvbXBvc2l0ZS5mcm9tSnNvbihmcm9tTG9hZGVyKVxuICAgICAgICAgIGNvbXBvc2l0ZXMucHVzaCh7IHNyYywgY29tcG9zaXRlIH0pXG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycilcbiAgICAgIH1cblxuICAgICAgZGVsZXRlIGNvbXBvc2l0ZUZyb21Mb2FkZXJbc3JjXVxuICAgIH1cblxuICAgIHJldHVybiBjb21wb3NpdGVzLmZpbmQoKGl0ZW0pID0+IGl0ZW0uc3JjID09PSBzcmMpIHx8IG51bGxcbiAgfVxufVxuIl19